const MAP_LAYERS = [
    {
     "chunks":[
            {
             "data":[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                386, 386, 386, 386, 386, 386, 386, 387, 382, 383, 385, 386, 387, 382, 383, 385,
                388, 389, 384, 384, 382, 388, 389, 397, 398, 398, 399, 384, 391, 388, 389, 391,
                394, 395, 384, 384, 382, 394, 395, 384, 384, 388, 389, 384, 391, 394, 395, 391,
                384, 390, 383, 390, 388, 389, 388, 389, 384, 394, 395, 384, 391, 384, 385, 399,
                398, 399, 383, 397, 394, 395, 394, 395, 398, 398, 388, 389, 397, 398, 399, 388,
                384, 383, 388, 389, 384, 384, 384, 384, 388, 389, 394, 395, 384, 384, 384, 394,
                383, 384, 394, 395, 384, 382, 382, 382, 394, 395, 384, 384, 384, 384, 384, 384],
             "height":16,
             "width":16,
             "x":0,
             "y":16
            }, 
            {
             "data":[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                386, 386, 386, 386, 386, 387, 382, 383, 385, 386, 386, 386, 386, 386, 386, 387,
                388, 389, 383, 384, 384, 397, 398, 398, 399, 382, 383, 384, 384, 388, 389, 393,
                394, 395, 383, 384, 384, 384, 384, 388, 389, 384, 384, 384, 390, 394, 395, 393,
                382, 383, 388, 389, 390, 390, 390, 394, 395, 382, 390, 384, 393, 388, 389, 393,
                389, 384, 394, 395, 391, 391, 391, 382, 384, 382, 393, 385, 399, 394, 395, 393,
                395, 384, 388, 389, 391, 391, 391, 382, 384, 384, 393, 393, 384, 388, 389, 393,
                384, 384, 394, 395, 396, 396, 396, 382, 384, 384, 393, 393, 384, 394, 395, 393],
             "height":16,
             "width":16,
             "x":16,
             "y":16
            }, 
            {
             "data":[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 384, 384, 400, 401, 382, 383, 400, 401, 382, 383, 400, 401,
                0, 0, 0, 0, 388, 389, 406, 407, 390, 384, 406, 407, 384, 384, 406, 407,
                0, 0, 0, 0, 394, 395, 406, 407, 391, 384, 406, 407, 382, 384, 406, 407,
                0, 0, 0, 0, 388, 389, 406, 407, 391, 384, 406, 407, 388, 389, 406, 407,
                0, 0, 0, 0, 394, 395, 406, 407, 397, 387, 406, 407, 394, 395, 406, 407,
                0, 0, 0, 0, 388, 389, 406, 407, 384, 393, 406, 407, 388, 389, 406, 407,
                0, 0, 0, 0, 394, 395, 406, 407, 384, 393, 406, 407, 394, 395, 406, 407],
             "height":16,
             "width":16,
             "x":32,
             "y":16
            }, 
            {
             "data":[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                384, 390, 400, 401, 382, 383, 400, 401, 384, 384, 400, 401, 390, 384, 400, 401,
                384, 393, 406, 407, 384, 384, 406, 407, 388, 389, 406, 407, 397, 387, 406, 407,
                385, 399, 406, 407, 390, 384, 406, 407, 394, 395, 406, 407, 382, 393, 406, 407,
                391, 382, 406, 407, 396, 383, 406, 407, 390, 390, 406, 407, 384, 393, 406, 407,
                391, 382, 406, 407, 382, 382, 406, 407, 391, 391, 406, 407, 384, 393, 406, 407,
                397, 387, 406, 407, 388, 389, 406, 407, 396, 396, 406, 407, 385, 399, 406, 407,
                384, 393, 406, 407, 394, 395, 406, 407, 382, 383, 406, 407, 391, 384, 406, 407],
             "height":16,
             "width":16,
             "x":48,
             "y":16
            }],
     "height":16,
     "id":2,
     "name":"\u0424\u043e\u043d 1",
     "opacity":1,
     "startx":0,
     "starty":16,
     "type":"tilelayer",
     "visible":true,
     "width":64,
     "x":0,
     "y":0
    }, 
    {
     "chunks":[
            {
             "data":[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                422, 429, 422, 422, 422, 423, 422, 422, 422, 428, 422, 422, 422, 423, 422, 422,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
             "height":16,
             "width":16,
             "x":0,
             "y":16
            }, 
            {
             "data":[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                422, 422, 429, 422, 422, 423, 422, 422, 422, 428, 422, 422, 423, 422, 422, 422,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
             "height":16,
             "width":16,
             "x":16,
             "y":16
            }, 
            {
             "data":[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 402, 376, 377, 378, 379, 376, 377, 378, 379, 376, 377, 378, 379,
                0, 0, 0, 408, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 408, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 408, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 408, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 408, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 408, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 408, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
             "height":16,
             "width":16,
             "x":32,
             "y":16
            }, 
            {
             "data":[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 402, 376, 377, 378, 379, 376, 377, 378, 379, 376, 377,
                0, 0, 0, 0, 0, 414, 405, 415, 415, 405, 415, 415, 405, 415, 405, 415,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                376, 377, 378, 379, 376, 377, 378, 379, 376, 377, 378, 379, 376, 377, 378, 379,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
             "height":16,
             "width":16,
             "x":48,
             "y":16
            }],
     "height":16,
     "id":1,
     "name":"\u041f\u0435\u0440\u0435\u0434\u043d\u0438\u0439 \u0441\u043b\u043e\u0439",
     "opacity":1,
     "startx":0,
     "starty":16,
     "type":"tilelayer",
     "visible":true,
     "width":64,
     "x":0,
     "y":0
}];

const MAP_WIDTH = 64;

/**
 * @type {Array<{x: number, y: number}>}
 */
const COLLISION_BLOCKS = []; //=Data Map
MAP_LAYERS[1]['chunks'].forEach(block=>{
    block.data.forEach((tile, i)=>{
        if(tile !== 0){
            COLLISION_BLOCKS.push({x: i%block.width+block.x, y: Math.floor(i/block.width)+block.y})
        }
    })
});

const MAP_DRAWN_WIDTH = window.innerWidth * GLOBAS_SCALE * 1.5;

const map = new Image();
map.src = `images/map.png`;
const TILE_SIZE = MAP_DRAWN_WIDTH * MAP_WIDTH / map.width;